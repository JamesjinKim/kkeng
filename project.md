# 연구개발 기획서: AI 기반 능동형 하수처리 무인 자동화 시스템 개발

---

## 1. 연구개발의 개요 (Project Overview)

### 1.1. 핵심 개념
본 연구는 기존의 '사후 대응(Feedback)' 방식 하수처리 제어를 **'유입수 성상 예측 기반의 사전 대응(Feed-forward)'** 방식으로 혁신하는 AI 솔루션 개발입니다. 유입 단계에서 수질, 유량 등을 선제적으로 감지하고, AI(Bi-LSTM)가 미래 부하를 예측하여 송풍기 및 펌프를 최적 제어(PSO)함으로써 **완전 무인 자동운전**을 실현합니다.

### 1.2. 연구 배경
- **현황**: 국내 하수처리장은 지자체 전력의 30~40%를 소비하며, 운영 인력 부족으로 무인화 수요가 급증하고 있습니다.
- **문제점**: 현재의 사후 제어 방식은 반응 속도가 느려 수질 기준 초과 위험이 있고, 과잉 포기(Over-aeration)로 인한 에너지 낭비가 심각합니다.

---

## 2. 연구개발 목표 (Research Goals)

### 2.1. 최종 목표
1. **유입수 기반 예측 제어**: 6시간 후의 수질 및 부하를 예측하여 선제적 공정 제어
2. **완전 무인 자동운전**: AI 운전 모드 적용 시 운영자 개입 없는 자율 운전 (72시간 연속)
3. **에너지 효율화**: 송풍기 및 펌프 제어 최적화를 통한 전력 소비 15% 절감
4. **Edge AI 상용화**: 라즈베리파이 기반의 저비용 고효율 현장 독립형 제어 시스템 구축

### 2.2. 핵심 성과 지표 (KPI)
| 구분 | 성능지표 | 목표치 | 비고 |
|------|----------|--------|------|
| **수질 안정성** | 방류수 수질 기준 초과 | **0회/년** | 법적 기준 100% 준수 |
| **에너지 효율** | 전력 소비 절감률 | **15% 이상** | 기존 대비 |
| **예측 정확도** | 유입 부하 예측 MAPE | **10% 이하** | 6시간 선행 예측 |
| **자동화 수준** | 무인 운전 지속 시간 | **72시간 이상** | 운영자 개입 없음 |
| **경제성** | 투자 회수 기간 (ROI) | **5년 이내** | CAPEX + OPEX |

---

## 3. 주요 연구 내용 및 핵심 기술 (Core Technology)

### 3.1. Sensing Layer: 유입수 기반 능동형 센싱
- **다중 센서 네트워크**: pH, 수온, SS, COD, BOD, NH₄-N, 유량, ORP 등 10종 이상의 센서를 유입구 및 주요 공정에 설치하여 1분 단위 데이터 수집.
- **데이터 품질 관리(QA/QC)**: 이상치 탐지(3σ, IQR), 결측치 보간(Linear/Spline), 센서 드리프트 보정 알고리즘 적용.

### 3.2. Analytics Layer: Control-Aware AI 알고리즘
- **예측 모델 (Bi-LSTM + Attention)**:
    - 과거 72시간의 시계열 데이터를 분석하여 향후 6시간의 방류 수질(COD, BOD, SS, T-N, T-P)을 예측.
    - **Attention Mechanism**: 급격한 유입 부하 변동이나 이상 징후 시점에 가중치를 부여하여 예측 정확도 향상.
- **최적화 엔진 (PSO, Particle Swarm Optimization)**:
    - AI 예측값을 기반으로 비용(전력비+약품비)을 최소화하고 수질 기준을 만족하는 최적의 제어 파라미터(송풍량, 약품 투입량, 반송률)를 30분 주기로 탐색.
    - **Control-Aware**: 제어 변수 변경에 따른 미래 수질 변화를 시뮬레이션하여 최적해 도출.

### 3.3. Control Layer: 하이브리드 제어 시스템
- **Feed-forward (주 제어)**: 유입 부하 예측에 따라 송풍기 RPM, 약품 투입량을 선제적으로 조절.
- **Feedback (보조 제어)**: 방류수 실측값을 통해 예측 오차를 보정하고 미세 조정 수행.
- **인터락(Interlock) 및 안전장치**: 수위, 압력, pH 등 물리적 제약 조건을 실시간 감시하여 설비 보호 및 비상 시 Rule-based 제어로 자동 전환.

### 3.4. Edge AI Infrastructure (3-Tier 하이브리드 아키텍처)

> 3-Tier 전체 구조도는 [README.md](README.md)를 참조하세요.
> 디렉토리 구조 및 개발 우선순위는 [PRD.md](PRD.md) 섹션 4.6을 참조하세요.

#### 3.4.1. 아키텍처 핵심 결정

- **AI 추론 위치**: Tier 2 (Gateway)에서 수행
- **근거**: 데이터 흐름 최적화, 모델 관리 용이, Tier 1 비용 절감
- **Fallback**: 네트워크 단절 시 Tier 1에서 Rule-based로 Tier 3 직접 제어

#### 3.4.2. Tier별 역할 및 비용

| Tier | 하드웨어 | 주요 역할 | 비용 |
|------|---------|----------|------|
| **Tier 1** | RPi 5 (4GB) | 센서 수집, QA/QC, 로컬 캐시, Fallback | ~$150 |
| **Tier 2** | Mini PC + Hailo-8L | **AI 추론**, PSO 최적화, DB, Dashboard | ~$300 |
| **Tier 3** | ESP32 + 릴레이 + PLC | 액추에이터 제어 (무인자동/반자동/수동) | ~$100 |
| | | **총 비용** | **~$550/현장** |

#### 3.4.3. 기술 구현

- **경량화**: TensorFlow → ONNX → Hailo HEF 변환, INT8 양자화 (73% 경량화)
- **추론 성능**: 1~2초 (목표 2초 이내)
- **Cloud (장기 목표)**: 전국 데이터 통합 분석, 대규모 모델 재학습. 현재 보류.

### 3.5. 제어 계층 대안 분석: PLC vs 제어보드

#### 3.5.1. 검토 배경
기존 3-Tier 구조에서 PLC 계층을 제어보드(Arduino, ESP32 등)로 대체하여 AI Edge와 직접 연동하는 방안을 검토. 목적은 **PLC 개발비용 절감**과 **통신 프로토콜 효율화**.

```
[현재 3-Tier]                         [대안 구조]
Edge (AI) ──Modbus TCP──▶ PLC        Edge (AI) ──직접 연동──▶ 제어보드
                                                              (Arduino/ESP32)
```

#### 3.5.2. 장점 분석

| 항목 | 효과 |
|------|------|
| **비용 절감** | PLC 본체 수백만원 → 제어보드 수만원 (90%↓) |
| **통신 단순화** | Modbus 프로토콜 변환 불필요, 직접 Serial/SPI/I2C |
| **개발 유연성** | 오픈소스 생태계, 빠른 프로토타이핑 |
| **통합 용이성** | AI Edge와 동일 플랫폼(Python/C++)으로 통합 가능 |

#### 3.5.3. 우려 사항

**1) 산업용 신뢰성 문제**

| 항목 | PLC | Arduino/ESP32 |
|------|-----|---------------|
| 동작 온도 | -20~60°C | 0~50°C (소비자급) |
| 내구성 | 10년+ 연속 운전 | 검증 부족 |
| 노이즈 내성 | 산업용 EMC 인증 | 민감함 |
| MTBF | 수십만 시간 | 미검증 |

> ⚠️ 폐수처리장 환경: 고습도, 부식성 가스, 전기적 노이즈 → 소비자급 보드에 치명적

**2) 안전 인증 문제**
- 환경부 TMS 연동 시설 → 제어 시스템 신뢰성 요구
- 수질 기준 위반 시 법적 책임 → "검증된 제어 시스템" 필요
- 보험/인허가 심사 시 PLC 사용이 일반적 기준

**3) 실시간 제어 안정성**

| 항목 | PLC | 제어보드 |
|------|-----|---------|
| 스캔 타임 | 수 ms 보장 | OS 의존, 지터 발생 |
| Watchdog | 하드웨어 레벨 | 소프트웨어 의존 |
| 이중화 | 표준 지원 | 직접 구현 필요 |

#### 3.5.4. 대안 옵션

**옵션 A: 하이브리드 접근 (권장)**

```
Edge AI ──직접 연동──▶ 산업용 제어보드 ──▶ PLC (최소화)
         (예측/최적화)    (ESP32-S3 + 릴레이)   (인터락만)

- AI/최적화: Edge에서 수행
- 일반 제어: 산업용 제어보드 (ESP32 산업용 모듈)
- 안전 인터락: 최소 PLC (수위 HH, 과전류 보호 등)
```

→ **효과**: PLC 비용 70% 절감 + 안전성 유지

**옵션 B: 산업용 IoT 컨트롤러 사용**

| 제품 | 가격 | 특징 |
|------|------|------|
| Siemens IoT2040 | ~50만원 | 산업용, Linux 기반 |
| Revolution Pi | ~30만원 | Raspberry Pi 기반 산업용 |
| Wago PFC200 | ~80만원 | 경량 PLC, Linux 지원 |

→ PLC보다 저렴하면서 산업용 인증 확보

**옵션 C: 완전 제어보드 방식 (파일럿 한정)**

```
적용 조건:
✓ 파일럿/연구용 시설에서만 적용
✓ 상용화 전 PLC 전환 계획 수립
✓ 안전 인터락은 별도 하드웨어 회로로 구현
```

#### 3.5.5. 권장 전략

| 단계 | 권장 방안 | 비고 |
|------|----------|------|
| **단기 (파일럿)** | 옵션 A: 하이브리드 접근 | 핵심 인터락만 PLC 유지, 비용 60-70% 절감 |
| **장기 (상용화)** | 옵션 B: 산업용 IoT 컨트롤러 | 인허가/보험 심사 대응, 10년+ 안정성 |

> **결론**: 파일럿 단계에서 제어보드 방식을 테스트하고, 상용화 시 검증된 결과를 바탕으로 최종 결정하는 것이 리스크 관리 측면에서 바람직함.

---

## 4. 검증 및 안전성 확보 (Verification & Safety)

### 4.1. Ground Truth 검증 (3-Tier 전략)
- **Tier 1 (실시간)**: 센서 간 상관관계 분석을 통한 실시간 이상 탐지.
- **Tier 2 (일간)**: 온라인 분석기 값과 AI 예측값 비교 (MAPE 모니터링).
- **Tier 3 (주간)**: 실험실 정밀 분석 결과와 비교하여 모델 성능 검증 및 재학습 트리거.

### 4.2. 리스크 관리
- **Fail-Safe**: AI 모델 신뢰도 저하 시 자동으로 안전 모드(Rule-based) 또는 비상 모드로 전환.
- **이중화**: 주요 센서 및 펌프의 하드웨어 이중화, Edge 디바이스의 Active-Standby 구성.

---

## 5. 추진 일정 및 전략 (Roadmap)

### 1단계: 기반 구축 및 설계 (1~4개월)
- 현장 정밀 진단 및 센서 네트워크 구축
- 데이터 수집 파이프라인 및 Edge 인프라 설치
- 초기 데이터 확보 (Cold Start 대응)

### 2단계: 알고리즘 개발 및 시뮬레이션 (5~8개월)
- Bi-LSTM 예측 모델 및 PSO 최적화 엔진 개발
- 가상 환경 시뮬레이션을 통한 제어 로직 검증
- Edge AI 모델 경량화 및 포팅

### 3단계: 현장 실증 및 최적화 (9~12개월)
- 실제 플랜트(금강엔지니어링) 적용 및 시운전
- AI 제어 모드 단계적 확대 (모니터링 → 보조 제어 → 완전 자동)
- 성능 평가 및 공인 인증 획득

---

## 6. 기대 효과 (Expected Outcomes)

### 6.1. 기술적 측면
- 데이터 기반의 정밀 제어로 수질 안정성 확보 (Human Error 제거)
- 저비용 고효율 Edge AI 솔루션으로 소규모 처리장까지 스마트화 확산

### 6.2. 경제적/환경적 측면
- **운영비 절감**: 전력비 15%, 약품비 10% 절감 및 슬러지 처리비용 감소.
- **탄소 중립**: 에너지 효율화를 통한 온실가스 감축 기여.
- **수명 연장**: 설비의 최적 운전으로 과부하 방지 및 수명 연장.

### 6.3. 사회적 측면
- 기피 시설의 무인화/자동화로 운영 인력난 해소 및 근무 환경 개선.
- 방류 수질 신뢰도 향상으로 지역 주민과의 갈등 완화.
