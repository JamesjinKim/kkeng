# EC-MBR AI 무인 자동화 시스템 개발 체크리스트

**기준 문서:** PRD.md v2.0
**작성일:** 2026-02-02
**목적:** 3-Tier 아키텍처 기반 개발 단계별 구현 점검

---

## 목차

1. [Phase 1: 기반 구축 및 설계 (1~2개월)](#phase-1-기반-구축-및-설계-2개월)
2. [Phase 2: 알고리즘 개발 및 시뮬레이션 (2개월)](#phase-2-알고리즘-개발-및-시뮬레이션-2개월)
3. [Phase 3: 현장 실증 및 최적화 (5개월)](#phase-3-현장-실증-및-최적화-5개월)
4. [Tier별 개발 체크리스트](#tier별-개발-체크리스트)
5. [통합 테스트 체크리스트](#통합-테스트-체크리스트)

---

## Phase 1: 기반 구축 및 설계 (1~2개월)

### 1.1. 현장 진단 및 요구사항 분석

- [ ] 금강엔지니어링 현장 방문 및 기존 시스템 파악
- [ ] 기존 PLC 사양 확인 (LS 또는 Mitsubishi)
- [ ] Modbus TCP 통신 프로토콜 검증
- [ ] 기존 센서 목록 및 상태 점검
- [ ] 유입수/방류수 수질 이력 데이터 확보
- [ ] 운영 매뉴얼 기반 인터락 조건 매핑

### 1.2. 센서 네트워크 구축

#### 필수 센서 설치/검증

| 센서 | 범위 | 정확도 | 주기 | 상태 |
|------|------|--------|------|------|
| [ ] pH 센서 | 0~14 | ±0.1 | 1분 | |
| [ ] 수온 센서 | -10~50°C | ±0.5°C | 1분 | |
| [ ] SS (탁도계) | 0~500 mg/L | ±5% | 5분 | |
| [ ] COD (UV 흡광도) | 0~200 mg/L | ±10% | 15분 | |
| [ ] BOD (온라인 분석기) | 0~300 mg/L | ±15% | 1시간 | |
| [ ] NH₄-N 센서 | 0~50 mg/L | ±5% | 15분 | |
| [ ] DO (용존산소) | 0~20 ppm | ±0.2 mg/L | 1분 | |
| [ ] 유량계 | 0~500 m³/h | ±2% | 1분 | |
| [ ] ORP 센서 | -500~500 mV | ±10 mV | 1분 | |
| [ ] TMP (차압계) | 0~100 kPa | ±1% | 실시간 | |
| [ ] EC 전압계 | 0~50 V | ±1% | 10초 | |
| [ ] EC 전류계 | 0~100 A | ±1% | 10초 | |

#### 센서 네트워크 검증

- [ ] 센서 간 통신 테스트 (Modbus TCP/ADC/I2C/SPI)
- [ ] 데이터 수집 주기 검증 (1분 기본)
- [ ] 센서 이중화 구성 (핵심 센서)
- [ ] 센서 캘리브레이션 완료

### 1.3. 데이터 인프라 구축

#### 데이터베이스

- [ ] InfluxDB/TimescaleDB 설치 및 설정
- [ ] 스키마 설계 (시계열 데이터)
- [ ] 3년 보관 정책 설정
- [ ] 백업 정책 구성 (일일 자동 + 월간 외부)
- [ ] 데이터 압축 설정

#### 데이터 전처리 파이프라인

- [ ] 이상치 탐지 로직 (3σ + IQR + 물리적 범위)
- [ ] 결측치 처리 로직
  - [ ] 5분 이하: 선형 보간
  - [ ] 5~30분: Cubic Spline
  - [ ] 30분+: 과거 패턴 참조
- [ ] Kalman Filter 드리프트 보정
- [ ] 1분 단위 타임스탬프 동기화

### 1.4. 초기 데이터 확보 (Cold Start)

- [ ] 최소 500만 개 데이터 포인트 목표 설정
- [ ] 1.5년 × 10종 센서 × 1분 주기 데이터 수집 계획
- [ ] 기존 운영 이력 데이터 마이그레이션
- [ ] 데이터 품질 검증 (QA/QC)

---

## Phase 2: 알고리즘 개발 및 시뮬레이션 (5~8개월)

### 2.1. TCN 예측 모델 개발

#### 모델 아키텍처 구현

- [ ] TCN 기본 구조 구현
  - [ ] Dilated Causal Conv1D Block × 7
  - [ ] Dilation rates: 1, 2, 4, 8, 16, 32, 64
  - [ ] Receptive Field: 509 timesteps (~8.5시간)
- [ ] 각 Block 구성요소
  - [ ] Conv1D(64, kernel=3)
  - [ ] BatchNorm
  - [ ] ReLU 활성화
  - [ ] Dropout(0.2)
  - [ ] Residual Connection
- [ ] Global Average Pooling 1D
- [ ] Control Variable 융합 레이어
- [ ] Output Dense Layer (15개 출력)

#### 입력 데이터 구조

- [ ] 시계열 데이터 준비 (72시간 × 25 features)
  - [ ] 센서 직접값 15개
  - [ ] 파생 변수 7개 (F/M비, HRT, SRT 등)
  - [ ] 시간 변수 3개 (시간대, 요일, 계절)
- [ ] 제어 변수 4개 (송풍량, PAC, Polymer, 전류밀도)

#### 학습 설정

- [ ] 데이터 분할: Train 70% / Validation 15% / Test 15%
- [ ] Optimizer: Adam (lr=0.001)
- [ ] Loss: Huber Loss
- [ ] Batch Size: 128
- [ ] Epochs: 200 (Early Stopping patience=20)
- [ ] Regularization: L2 (λ=0.001) + Dropout

#### 성능 검증

- [ ] MAPE < 10% 달성
- [ ] R² Score > 0.85 달성
- [ ] 방향 정확도 > 90% 달성
- [ ] 추론 시간 < 1.5초 (엣지)
- [ ] 모델 크기 < 5MB (INT8)

### 2.2. 모델 변환 파이프라인

- [ ] TensorFlow 모델 (.h5) 저장
- [ ] tf2onnx 변환 → ONNX 포맷
- [ ] Hailo Dataflow Compiler 설정
- [ ] INT8 양자화 수행
- [ ] HEF 파일 생성 (~4.5MB)
- [ ] NPU 추론 테스트 (0.8~1.2초 목표)
- [ ] CPU Fallback 모델 준비 (TFLite)

### 2.3. EC-MBR 특화 모델

- [ ] 전극 수명 예측 모델
  - [ ] 입력: 전압변동, 전류밀도, 운전시간
  - [ ] 출력: 잔여수명(hr)
  - [ ] 극전환 주기 자동 최적화 로직
- [ ] 동적막 형성 예측 모델
  - [ ] 입력: 전기응집 조건, TMP
  - [ ] 출력: 최적 동적막 상태
- [ ] 통합 오염 예측 모델
  - [ ] 전극+막 동시 관리
  - [ ] 세정 스케줄 출력

### 2.4. PSO 최적화 엔진 개발

#### 기본 구현

- [ ] PSO 알고리즘 구현
- [ ] 입자 수: 20개
- [ ] 세대 수: 15세대
- [ ] Early Stopping: 3세대 무개선 시
- [ ] 배치 추론: 20개 입자 동시 평가

#### 목적함수

- [ ] 전력비용 (송풍기+전기응집) 계산
- [ ] 약품비용 계산
- [ ] 전극소모비용 계산
- [ ] 수질위반 페널티 계산
- [ ] 가중치 설정: α₁=0.5, α₂=0.2, α₃=0.2, α₄=0.1

#### 제약조건 구현

- [ ] COD ≤ 32 mg/L (법적 40, 20% 마진)
- [ ] BOD ≤ 8 mg/L (법적 10)
- [ ] SS ≤ 8 mg/L (법적 10)
- [ ] T-N ≤ 16 mg/L (법적 20)
- [ ] T-P ≤ 1.6 mg/L (법적 2)

#### 최적화 대상 변수

- [ ] 약품 투입량 (PAC, Polymer, NaOH)
- [ ] 펌프 운전 스케줄 (24시간)
- [ ] 터보 브로워 속도 (0~100%)
- [ ] 분리막 운전 사이클 (흡입/휴지)
- [ ] 전기응집 전류밀도, 극전환 주기

#### 실행 조건

- [ ] 정상 운전: 30분 주기
- [ ] 부하 급변: 즉시 실행 (5분 내)
- [ ] 긴급 상황: Rule-based 전환

### 2.5. 제어 로직 개발

#### Feed-forward 제어

- [ ] 6시간 선행 예측 기반 제어 로직
- [ ] AI 제어 90% + Feedback 보정 10% 구현
- [ ] |실측 - 예측| > 20% 시 가중치 조정

#### 부하 기반 제어

- [ ] 고부하 (BOD > 200): 송풍기 +25%, 반송슬러지 75%
- [ ] 저부하 (BOD < 80): Eco Mode, 송풍기 -20%
- [ ] 정상 (80~200): DO 2.0~2.5 mg/L 유지
- [ ] 저온 보정 (수온 < 10°C): 송풍량 +15%
- [ ] 질산화 강화 (NH₄-N > 30): DO 3.5 mg/L

#### EC-MBR 통합 제어

- [ ] 유입 COD > 150: 전류밀도 ×1.3, 극전환 30→20분
- [ ] 전압 변동율 > 30%: 초음파 세정, 극전환 즉시
- [ ] TMP 상승률 > 2 kPa/hr: 전기응집 강화
- [ ] TMP > 40 kPa: 전기응집 일시 중단

### 2.6. Safety Layer 구현 (6층 검증)

- [ ] Layer 1: 물리적 제약 검증
  - [ ] 송풍량 ≤ 22 m³/min
  - [ ] 전류밀도 ≤ 15 A/m²
  - [ ] 펌프 용량 초과 여부
- [ ] Layer 2: 예측 신뢰도 검증
  - [ ] Uncertainty < 0.3 확인
  - [ ] 위반 시 보수적 제어 (안전계수 ×1.2)
- [ ] Layer 3: 법적 기준 검증
  - [ ] 예상 방류 COD < 32 mg/L
  - [ ] 위반 시 긴급 제어 (송풍량 MAX)
- [ ] Layer 4: 센서 이상 검증
  - [ ] 복수 센서 동시 이상 감지
  - [ ] 위반 시 수동 모드 전환
- [ ] Layer 5: 전극 보호 (EC 특화)
  - [ ] 전압 변동율 < 30%
  - [ ] 전압 급상승 (>5V/min) 감지
  - [ ] 위반 시 EC 정지 + 초음파 세정
- [ ] Layer 6: 막 보호 (MBR 특화)
  - [ ] TMP < 50 kPa
  - [ ] 흡입펌프 연속가동 < 7분
  - [ ] 위반 시 흡입펌프 정지

### 2.7. 인터락 제어 구현

#### 수위 기반 인터락

- [ ] 분리막조 L (저수위): 흡입펌프 정지
- [ ] 분리막조 HH (고수위): 1차처리수조 펌프 정지
- [ ] 분리막조 HHAL (초고수위): 경보 + 유량조정조 펌프 정지
- [ ] 1차처리수조 HH: 유량조정조 펌프 정지
- [ ] 여과수조 H: 흡입펌프 정지
- [ ] 방류조 HH: 여과수조 펌프 정지

#### DAF 연동 시퀀스

- [ ] 유량조정조 펌프 ON → SOL-101 밸브 열림
- [ ] 순환수 가압펌프 가동
- [ ] PAC 약품펌프 가동
- [ ] 교반기 가동 (반응조/pH조정조/응집조)
- [ ] 폴리머 약품펌프 가동
- [ ] OFF 시 역순 정지 (지연 시간 적용)

### 2.8. 제어 모드 구현 (4단계)

- [ ] 정상 AI 모드
  - [ ] TCN: 5분 주기
  - [ ] PSO: 30분 주기
  - [ ] 송풍기: PSO 최적값
- [ ] 안전 모드
  - [ ] TCN: 10분 주기
  - [ ] PSO: 중단
  - [ ] 송풍기: DO 2.5 mg/L 고정
- [ ] 비상 모드
  - [ ] TCN/PSO: 중단
  - [ ] 송풍기: 최대 가동
- [ ] Eco 모드
  - [ ] TCN: 30분 주기
  - [ ] PSO: 1시간 주기
  - [ ] 송풍기: 간헐 포기

#### 모드 전환 조건

- [ ] 정상 AI → 안전: Anomaly > 0.7, 불확실성 > 0.3, 센서 2개+ 이상
- [ ] 안전 → 비상: 방류 COD > 36, 터보 브로워 정지, TMP > 50 kPa
- [ ] 비상 → 안전: 방류수질 < 법적 70% 회복
- [ ] 안전 → 정상 AI: 24시간 연속 안정, MAPE < 10%, 센서 정상

### 2.9. 시뮬레이션 검증

- [ ] 가상 환경 구축 (시뮬레이터)
- [ ] 정상 운전 시나리오 테스트
- [ ] 고부하/저부하 시나리오 테스트
- [ ] 센서 장애 시나리오 테스트
- [ ] 장비 고장 시나리오 테스트
- [ ] 긴급 상황 시나리오 테스트

---

## Phase 3: 현장 실증 및 최적화 (5개월)

### 3.1. 현장 적용 단계

#### 모니터링 단계 (2주)

- [ ] AI 예측만 실행 (실제 제어 없음)
- [ ] 예측 정확도 검증 (MAPE < 10%)
- [ ] 운영자 피드백 수집
- [ ] 시스템 안정성 확인

#### 반자동 단계 (2주)

- [ ] AI 권장 + 운영자 승인 방식
- [ ] 권장 수용률 모니터링
- [ ] 수동 개입 사유 분석
- [ ] 권장 알고리즘 개선

#### 완전 자동 단계 (4주)

- [ ] 주간 완전 자동 운전
- [ ] 야간 비상 대기 체계
- [ ] 무인 운전 시간 점진적 확대
- [ ] 이상 상황 대응 검증

#### 72시간 무인 운전

- [ ] 운영자 개입 없는 자율 운전 달성
- [ ] 수질 기준 100% 준수 확인
- [ ] 에너지 절감 15% 달성 확인
- [ ] 시스템 안정성 최종 검증

### 3.2. 성능 최적화

#### KPI 달성 검증

| KPI | 목표치 | 달성 | 비고 |
|-----|--------|------|------|
| [ ] 수질 기준 초과 | 0회/년 | | 법적 기준 100% |
| [ ] 전력 절감률 | 15% 이상 | | 기존 대비 |
| [ ] 예측 MAPE | 10% 이하 | | 6시간 선행 |
| [ ] 무인 운전 | 72시간 이상 | | 개입 없음 |
| [ ] ROI | 45일 이내 | | 엣지 기반 |

#### 모델 재학습

- [ ] 현장 데이터 기반 Fine-tuning
- [ ] 계절별 모델 최적화
- [ ] 주간 MAPE > 12% 시 재학습 트리거
- [ ] A/B 테스트 환경 구축

### 3.3. 운영 체계 구축

- [ ] 운영 매뉴얼 작성
- [ ] 비상 대응 절차서 작성
- [ ] 운영자 교육 프로그램
- [ ] 유지보수 일정 수립
- [ ] 모니터링 대시보드 최종 구성

### 3.4. 공인 인증

- [ ] 성능 평가 데이터 수집
- [ ] 공인 시험 기관 테스트
- [ ] 인증 서류 준비
- [ ] 인증 획득

---

## Tier별 개발 체크리스트

### Tier 1: 엣지 디바이스 (Raspberry Pi 5)

#### 하드웨어 구성

- [ ] Raspberry Pi 5 (4~8GB RAM) 준비
- [ ] 128GB microSD 설치
- [ ] ADC/I2C/SPI 센서 인터페이스 연결
- [ ] 산업용 DIN 레일 케이스 (IP65) 장착
- [ ] 전원 공급 (3~5W) 확인

#### 소프트웨어 개발

- [ ] Raspberry Pi OS (64-bit) 설치
- [ ] UV 가상환경 설정
- [ ] 센서 데이터 수집 모듈 (1분 주기)
  - [ ] Modbus TCP 클라이언트
  - [ ] ADC 센서 읽기
  - [ ] I2C/SPI 센서 읽기
- [ ] QA/QC 전처리 모듈
  - [ ] 이상치 탐지
  - [ ] 결측치 보간
- [ ] 로컬 버퍼 (24시간 캐시)
- [ ] MQTT 전송 모듈 (Tier 2로 1분 주기)

#### Fallback 제어 구현

- [ ] DO < 1.5 mg/L: 송풍기 RPM +20%
- [ ] pH < 6.5: NaOH 펌프 ON
- [ ] 수위 > HH: 유입펌프 OFF
- [ ] 네트워크 단절 감지 및 자동 전환

#### 테스트

- [ ] 센서 데이터 수집 테스트
- [ ] MQTT 전송 테스트
- [ ] Fallback 제어 테스트
- [ ] 24시간 연속 운전 테스트

---

### Tier 2: 게이트웨이 (RPi 5(16G) + Hailo-8L)

#### 하드웨어 구성

- [ ] RPi 5 (16GB RAM) 준비
- [ ] Hailo AI Kit (Hailo-8L NPU, 13 TOPS) 설치
- [ ] 256GB SSD 장착
- [ ] 네트워크 연결 확인

#### 데이터베이스

- [ ] InfluxDB 설치 및 설정
- [ ] 데이터 스키마 생성
- [ ] 3년 보관 정책 설정
- [ ] 백업 자동화 설정

#### AI 추론 엔진

- [ ] Hailo SDK 설치
- [ ] TCN 모델 (HEF) 로드
- [ ] NPU 추론 테스트 (0.8~1.2초)
- [ ] CPU Fallback (TFLite) 준비
- [ ] 5분 주기 예측 스케줄러

#### PSO 최적화 엔진

- [ ] PSO 알고리즘 배포
- [ ] 30분 주기 실행 스케줄러
- [ ] 실행 시간 검증 (~45초)
- [ ] 부하 급변 시 즉시 실행 로직

#### Safety Layer

- [ ] 6층 검증 로직 배포
- [ ] 실시간 검증 (< 100ms)
- [ ] 모드 전환 자동화

#### 모니터링 대시보드

- [ ] Grafana 설치
- [ ] 실시간 데이터 시각화
- [ ] 알람 설정
- [ ] 모바일 접근 설정

#### API 서버

- [ ] FastAPI 백엔드 구축
- [ ] 인증/인가 구현
- [ ] API 문서 자동화 (Swagger)
- [ ] OTA 업데이트 엔드포인트

#### 다중 현장 지원

- [ ] 5~10개 Tier 1 관리 구조
- [ ] 현장별 모델 분리
- [ ] 중앙 모니터링 대시보드

#### 테스트

- [ ] NPU 추론 성능 테스트
- [ ] PSO 최적화 테스트
- [ ] Safety Layer 검증 테스트
- [ ] 장애 복구 테스트

---

### Tier 3: 제어 계층 (ESP32 + Safety PLC)

#### 하드웨어 구성

- [ ] ESP32/Arduino (산업용 모듈) 준비
- [ ] 솔리드스테이트 릴레이 모듈 연결
- [ ] Safety PLC (핵심 인터락용) 설치
- [ ] 액추에이터 연결 확인

#### 운전 모드 구현

- [ ] 무인자동 모드
  - [ ] AI Feed-forward 제어
  - [ ] PSO 최적값 자동 적용
- [ ] 반자동 모드
  - [ ] AI 권장 표시
  - [ ] 운영자 승인 로직
- [ ] 수동 모드
  - [ ] 운영자 직접 제어
  - [ ] AI 모니터링만

#### PLC 통신

- [ ] Modbus TCP/RTU 통신 구현
- [ ] 제어 명령 전송 (< 10ms)
- [ ] 상태 피드백 수신
- [ ] 통신 장애 감지

#### 인터락 제어

- [ ] 하드와이어드 인터락 확인
- [ ] 소프트웨어 인터락 구현
- [ ] 인터락 동작 테스트

#### 테스트

- [ ] 각 운전 모드 테스트
- [ ] PLC 통신 테스트
- [ ] 인터락 동작 테스트
- [ ] 비상 정지 테스트

---

## 통합 테스트 체크리스트

### 시스템 통합

- [ ] Tier 1 ↔ Tier 2 통신 테스트 (MQTT)
- [ ] Tier 2 ↔ Tier 3 통신 테스트 (Modbus)
- [ ] Tier 1 ↔ Tier 3 Fallback 테스트
- [ ] 전체 데이터 흐름 검증

### 데이터 압축/전송

- [ ] Edge → Gateway: 60% 압축률 확인
- [ ] Gateway → Cloud: 96% 압축률 확인
- [ ] 일일 전송량 검증 (28.8MB/현장)

### 장애 복구

- [ ] NPU 장애 → CPU Fallback 테스트
- [ ] 네트워크 장애 → 엣지 독립 운전 테스트
- [ ] N+1 이중화 Failover (< 60초) 테스트
- [ ] 센서 고장 시 추정값 사용 테스트

### 환경 내구성

- [ ] IP68 인클로저 방수/방진 테스트
- [ ] CPU > 75°C 팬 부스트 테스트
- [ ] 습도 > 85% 경보 테스트

### 보안

- [ ] 통신 암호화 (TLS) 확인
- [ ] 인증/인가 테스트
- [ ] 접근 로그 기록 확인
- [ ] 펌웨어 무결성 검증

### 성능 종합

| 항목 | 목표 | 결과 |
|------|------|------|
| [ ] TCN 추론 시간 | < 1.5초 | |
| [ ] PSO 실행 시간 | < 45초 | |
| [ ] Safety Layer | < 100ms | |
| [ ] PLC 통신 | < 10ms | |
| [ ] Failover | < 60초 | |

---

## 문서 갱신 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0 | 2026-02-02 | 초기 작성 | - |

---

**문서 끝**
